<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Velocidad (f/m)</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#f5f5f7">

<style>
body{
    margin:0;
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
    background:#e9ecef;
    display:flex;
    justify-content:center;
    padding:20px 0;
}

.container{
    width:100%;
    max-width:420px;
}

.card{
    background:white;
    border-radius:18px;
    padding:20px;
    box-shadow:0 10px 30px rgba(0,0,0,0.08);
}

h1{
    text-align:center;
    margin-bottom:20px;
    font-size:20px;
}

/* TABLA estilo Excel */
table{
    width:100%;
    border-collapse:collapse;
    font-size:14px;
}

th, td{
    border:1px solid #d0d0d0;
    padding:10px;
    text-align:center;
}

th{
    background:#f2f2f2;
    font-weight:600;
}

input{
    width:100%;
    border:none;
    outline:none;
    text-align:center;
    font-size:14px;
}

button{
    margin-top:15px;
    width:100%;
    padding:12px;
    border:none;
    border-radius:12px;
    background:#1a73e8;
    color:white;
    font-size:15px;
    cursor:pointer;
}

button:active{
    transform:scale(0.98);
}

.result-highlight{
    background:#f8f9fa;
    font-weight:600;
}
</style>
</head>

<body>

<div class="container">
<div class="card">

<h1>Velocidad (f/m)</h1>

<table>
<tr>
    <th>Antes correg.</th>
    <th>Corregido</th>
</tr>

<tr>
    <td><input type="number" id="v1"></td>
    <td id="c1">0</td>
</tr>

<tr>
    <td><input type="number" id="v2"></td>
    <td id="c2">0</td>
</tr>

<tr>
    <td><input type="number" id="v3"></td>
    <td id="c3">0</td>
</tr>

<tr class="result-highlight">
    <td>VPROM</td>
    <td id="vprom">0</td>
</tr>

<tr class="result-highlight">
    <td>σ</td>
    <td id="sigma">0</td>
</tr>

<tr class="result-highlight">
    <td>CV (%)</td>
    <td id="cv">0</td>
</tr>

</table>

<button onclick="calcular()">Calcular</button>

</div>
</div>

<script>
const inputs = ["v1","v2","v3"];

inputs.forEach(id=>{
    document.getElementById(id).addEventListener("input", calcular);
});

function calcular(){

    let valores = inputs
        .map(id => parseFloat(document.getElementById(id).value))
        .filter(v => !isNaN(v));

    // Si no hay datos → limpiar todo
    if(valores.length === 0){
        limpiarResultados();
        return;
    }

    let promedio = valores.reduce((a,b)=>a+b,0) / valores.length;

    // Calcular corregidos respetando posiciones
    inputs.forEach((id,index)=>{
        let valor = parseFloat(document.getElementById(id).value);
        let celda = document.getElementById("c"+(index+1));

        if(!isNaN(valor)){
            celda.textContent = (valor - promedio).toFixed(2);
        } else {
            celda.textContent = "";
        }
    });

    // Sigma
    let suma = valores
        .map(v => Math.pow(v - promedio,2))
        .reduce((a,b)=>a+b,0);

    let sigma = Math.sqrt(suma / valores.length);

    let cv = promedio !== 0 ? (sigma/promedio)*100 : 0;

    document.getElementById("vprom").textContent = promedio.toFixed(2);
    document.getElementById("sigma").textContent = sigma.toFixed(2);
    document.getElementById("cv").textContent = cv.toFixed(2);
}

function limpiarResultados(){
    ["c1","c2","c3","vprom","sigma","cv"].forEach(id=>{
        document.getElementById(id).textContent = "";
    });
}

// Registrar Service Worker
if("serviceWorker" in navigator){
    navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>

